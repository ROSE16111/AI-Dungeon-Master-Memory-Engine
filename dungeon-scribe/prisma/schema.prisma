generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Campaign {
  id         String   @id @default(uuid())
  title      String
  startDate  DateTime @default(now())
  updateDate DateTime @updatedAt

  roles     Role[]
  allTxts   AllTxt[]
  summaries Summary[]
  resources Resource[]
}

model Role {
  id         String   @id @default(uuid())
  name       String
  level      Int
  campaignId String
  campaign   Campaign @relation(fields: [campaignId], references: [id])
}

model AllTxt {
  id         String   @id @default(uuid())
  content    String
  campaignId String
  campaign   Campaign @relation(fields: [campaignId], references: [id])
  createdAt  DateTime @default(now())
}

model Summary {
  id          String      @id @default(uuid())
  type        SummaryType
  content     String
  createdAt   DateTime    @default(now())
  roleName    String?
  campaignId  String
  imageBase64 String?
  campaign    Campaign    @relation(fields: [campaignId], references: [id])
}

enum SummaryType {
  session
  character
}

// resources-------------------------------------------------------------------
enum ResourceCategory {
  Map
  Background
  Others
}

model Resource {
  id         String            @id @default(uuid())
  title      String
  category   ResourceCategory  // ← enum
  fileUrl    String
  previewUrl String?
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  campaignId String
  campaign   Campaign          @relation(fields: [campaignId], references: [id])

  gridCols  Int?   // Number of horizontal grid cells (X) in the map view
  gridRows  Int?   // Number of vertical grid cells (Y) in the map view
  lightI     Int?             // Current light source Y position (row index i)）
  lightJ     Int?             // Current light source X position (column index j)
  lightRadius Int?            // Current light source radius (in grid units)
}


//model Session {
//  id           String   @id @default(cuid())
//  title        String
//  language     String   @default("auto")
//  source       String   @default("live") // live | upload
//  text         String
//  keyPhrases   Json
//  keySentences Json
//  createdAt    DateTime @default(now())
//}
